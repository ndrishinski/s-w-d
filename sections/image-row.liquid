{%- liquid
  assign gutter_width = 0
  assign aspect_total = 0
  if section.settings.enable_gutter
    assign gutter_width = 1
  endif
  assign gutter_total = gutter_width
  assign image_index = 0
  assign enable_zoom = section.settings.enable_zoom
-%}

{%- capture image_count -%}{%- if section.settings.image_1 -%}+{%- endif -%}{%- if section.settings.image_2 -%}+{%- endif -%}{%- if section.settings.image_3 -%}+{%- endif -%}{%- if section.settings.image_4 -%}+{%- endif -%}{%- endcapture -%}

{% comment %}
  If any image links are set, disable zoom
{% endcomment %}
{%- liquid
  if section.settings.image_1_link != blank or section.settings.image_2_link != blank or section.settings.image_3_link != blank or section.settings.image_4_link != blank
    assign enable_zoom = false
  endif
-%}

{%- style -%}

#imgRow-{{ section.id }}.spaceAbove {
padding-top: {{ section.settings.topSpacing }}px;
}
#imgRow-{{ section.id }}.spaceBelow {
padding-bottom: {{ section.settings.bottomSpacing }}px;
}

  @media only screen and (max-width:768px){
     
#imgRow-{{ section.id }}.spaceAbove {
padding-top: {{ section.settings.topSpacing | times:'0.5' }}px;
}
#imgRow-{{ section.id }}.spaceBelow {
padding-bottom: {{ section.settings.bottomSpacing | times:'0.5' }}px;
}
}

 {%- endstyle -%}

<div
  data-subsection
  data-section-id="{{ section.id }}"
  {% if enable_zoom %}
    data-section-type="photoswipe"
    data-zoom="true"
  {% endif %}
  style="background-color: {{ section.settings.bgColor }}"
  id="imgRow-{{ section.id }}"
   class="{% if section.settings.space_above %} spaceAbove{% endif %}{% if section.settings.space_below %} spaceBelow{% endif %} {% if section.settings.addOuterMargins %}addOuterMargins{% endif %}"
  >
  <div class="image-row{% if section.settings.enable_gutter %} image-row--gutters{% endif %}">
    {%- if section.settings.image_1 == blank and section.settings.image_2 == blank and section.settings.image_3 == blank and section.settings.image_4 == blank -%}
      <div class="image-row__placeholder">
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      </div>
      <div class="image-row__placeholder">
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      </div>
      <div class="image-row__placeholder">
        {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
      </div>
    {%- endif -%}

    {%- if section.settings.image_1 -%}
      {%- assign image_index = image_index | plus: 1 -%}
      <div data-aos="row-of-{{ image_count | size }}">
        <div class="image-row__image image-row-{{ section.id }}--1 image-wrap">
          {%- if section.settings.image_1_link != blank -%}
            <a href="{{ section.settings.image_1_link }}">
          {%- endif -%}
          {%- assign img_url = section.settings.image_1 | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
          {%- assign aspect_total = aspect_total | plus: section.settings.image_1.aspect_ratio -%}
          {%- assign gutter_total = gutter_total | plus: gutter_width -%}
          <img class="lazyload photoswipe__image js-photoswipe__zoom"
            data-index="{{ image_index }}"
            data-photoswipe-src="{{ section.settings.image_1.src | img_url: '1600x1600' }}"
            data-photoswipe-width="{{ section.settings.image_1.width }}"
            data-photoswipe-height="{{ section.settings.image_1.height }}"
            data-src="{{ img_url }}"
            data-widths="[180, 360, 540, 720, 900, 1080, 1500]"
            data-aspectratio="{{ section.settings.image_1.aspect_ratio }}"
            data-sizes="auto"
            alt="{{ section.settings.image_1.alt }}">
          {%- if section.settings.image_1_link != blank -%}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
    {%- if section.settings.image_2 -%}
      {%- assign image_index = image_index | plus: 1 -%}
      <div data-aos="row-of-{{ image_count | size }}">
        <div class="image-row__image image-row-{{ section.id }}--2 image-wrap">
          {%- if section.settings.image_2_link != blank -%}
            <a href="{{ section.settings.image_2_link }}">
          {%- endif -%}
          {%- assign img_url = section.settings.image_2 | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
          {%- assign aspect_total = aspect_total | plus: section.settings.image_2.aspect_ratio -%}
          {%- assign gutter_total = gutter_total | plus: gutter_width -%}
          <img class="lazyload photoswipe__image js-photoswipe__zoom"
            data-index="{{ image_index }}"
            data-photoswipe-src="{{ section.settings.image_2.src | img_url: '1600x1600' }}"
            data-photoswipe-width="{{ section.settings.image_2.width }}"
            data-photoswipe-height="{{ section.settings.image_2.height }}"
            data-src="{{ img_url }}"
            data-widths="[180, 360, 540, 720, 900, 1080]"
            data-aspectratio="{{ section.settings.image_2.aspect_ratio }}"
            data-sizes="auto"
            alt="{{ section.settings.image_2.alt }}">
          {%- if section.settings.image_2_link != blank -%}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
    {%- if section.settings.image_3 -%}
      {%- assign image_index = image_index | plus: 1 -%}
      <div data-aos="row-of-{{ image_count | size }}">
        <div class="image-row__image image-row-{{ section.id }}--3 image-wrap">
          {%- if section.settings.image_3_link != blank -%}
            <a href="{{ section.settings.image_3_link }}">
          {%- endif -%}
          {%- assign img_url = section.settings.image_3 | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
          {%- assign aspect_total = aspect_total | plus: section.settings.image_3.aspect_ratio -%}
          {%- assign gutter_total = gutter_total | plus: gutter_width -%}
          <img class="lazyload photoswipe__image js-photoswipe__zoom"
            data-index="{{ image_index }}"
            data-photoswipe-src="{{ section.settings.image_3.src | img_url: '1600x1600' }}"
            data-photoswipe-width="{{ section.settings.image_3.width }}"
            data-photoswipe-height="{{ section.settings.image_3.height }}"
            data-src="{{ img_url }}"
            data-widths="[180, 360, 540, 720, 900, 1080]"
            data-aspectratio="{{ section.settings.image_3.aspect_ratio }}"
            data-sizes="auto"
            alt="{{ section.settings.image_3.alt }}">
          {%- if section.settings.image_3_link != blank -%}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
    {%- if section.settings.image_4 -%}
      {%- assign image_index = image_index | plus: 1 -%}
      <div data-aos="row-of-{{ image_count | size }}">
        <div class="image-row__image image-row-{{ section.id }}--4 image-wrap">
          {%- if section.settings.image_4_link != blank -%}
            <a href="{{ section.settings.image_4_link }}">
          {%- endif -%}
          {%- assign img_url = section.settings.image_4 | img_url: '1x1' | replace: '_1x1.', '_{width}x.' -%}
          {%- assign aspect_total = aspect_total | plus: section.settings.image_4.aspect_ratio -%}
          {%- assign gutter_total = gutter_total | plus: gutter_width -%}
          <img class="lazyload photoswipe__image js-photoswipe__zoom"
            data-index="{{ image_index }}"
            data-photoswipe-src="{{ section.settings.image_4.src | img_url: '1600x1600' }}"
            data-photoswipe-width="{{ section.settings.image_4.width }}"
            data-photoswipe-height="{{ section.settings.image_4.height }}"
            data-src="{{ img_url }}"
            data-widths="[180, 360, 540, 720, 900, 1080]"
            data-aspectratio="{{ section.settings.image_4.aspect_ratio }}"
            data-sizes="auto"
            alt="{{ section.settings.image_4.alt }}">
          {%- if section.settings.image_4_link != blank -%}
            </a>
          {%- endif -%}
        </div>
      </div>
    {%- endif -%}
  </div>
</div>

{%- assign images_width = 100.0 | minus: gutter_total -%}
{%- style -%}
  .image-row-{{ section.id }}--1 {
    margin: 0 0 {{ gutter_width }}% {{ gutter_width }}%;
    width: {{ section.settings.image_1.aspect_ratio | divided_by: aspect_total | times: images_width }}% !important;
  }
  .image-row-{{ section.id }}--1:after {
    padding-bottom: {{ 100 | divided_by: section.settings.image_1.aspect_ratio }}%;
  }
  .image-row-{{ section.id }}--2 {
    margin: 0 0 {{ gutter_width }}% {{ gutter_width }}%;
    width: {{ section.settings.image_2.aspect_ratio | divided_by: aspect_total | times: images_width }}% !important;
  }
  .image-row-{{ section.id }}--2:after {
    padding-bottom: {{ 100 | divided_by: section.settings.image_2.aspect_ratio }}%;
  }
  .image-row-{{ section.id }}--3 {
    margin: 0 0 {{ gutter_width }}% {{ gutter_width }}%;
    width: {{ section.settings.image_3.aspect_ratio | divided_by: aspect_total | times: images_width }}% !important;
  }
  .image-row-{{ section.id }}--3:after {
    padding-bottom: {{ 100 | divided_by: section.settings.image_3.aspect_ratio }}%;
  }
  .image-row-{{ section.id }}--4 {
    margin: 0 0 {{ gutter_width }}% {{ gutter_width }}%;
    width: {{ section.settings.image_4.aspect_ratio | divided_by: aspect_total | times: images_width }}% !important;
  }
  .image-row-{{ section.id }}--4:after {
    padding-bottom: {{ 100 | divided_by: section.settings.image_4.aspect_ratio }}%;
  }
{%- endstyle -%}



{% schema %}
{
        "name": "Row of Images",
  "class": "index-section",
        "settings": [
          {
            "type": "image_picker",
            "id": "image_1",
            "label": "Image 1"
          },
          {
            "type": "url",
            "id": "image_1_link",
            "label": "Link 1",
            "info": "Optional"
          },
          {
            "type": "image_picker",
            "id": "image_2",
            "label": "Image 2"
          },
          {
            "type": "url",
            "id": "image_2_link",
            "label": "Link 2",
            "info": "Optional"
          },
          {
            "type": "image_picker",
            "id": "image_3",
            "label": "Image 3"
          },
          {
            "type": "url",
            "id": "image_3_link",
            "label": "Link 3",
            "info": "Optional"
          },
          {
            "type": "image_picker",
            "id": "image_4",
            "label": "Image 4"
          },
          {
            "type": "url",
            "id": "image_4_link",
            "label": "Link 4",
            "info": "Optional"
          },
          {
            "type": "checkbox",
            "id": "enable_gutter",
            "label": "Add spacing",
            "default": false
          },
          {
            "type": "checkbox",
            "id": "enable_zoom",
            "label": "Enable image zoom",
            "info": "Not active if any image links set",
            "default": true
          },
          {
      "type": "color",
      "id": "bgColor",
      "label": "Background Color"
    },
          {
      "type": "range",
      "id": "topSpacing",
      "label": "Top Spacing",
      "default": 75,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "space_above",
      "label": "Apply Top Spacing"
    },
     {
      "type": "range",
      "id": "bottomSpacing",
      "label": "Bottom Spacing",
      "default": 75,
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "space_below",
      "label": "Apply Bottom Spacing"
    }

        ],
  "presets": [
    {
      "name": "Row of Images",
      "category": "Custom"
    }
  ],
  "blocks": []
      }
{% endschema %}

{% stylesheet %}
{% endstylesheet %}

{% javascript %}
{% endjavascript %}